extends layout.pug

include ./mixins/follows.pug
include ./mixins/userpage-header.pug
include ./mixins/likes-and-comments.pug

append head
  link(rel="stylesheet" href="/stylesheets/user-page.css")
  link(rel="stylesheet" href="/stylesheets/components/likes-and-comments.css")
  script(src="/javascripts/comments.js" type="module" defer)
  script(src="/javascripts/likes.js" type='module' defer)

block content
  +userpageHeader(meme.User.username, meme.userId, isCurrentUser, isFollowing, currentUserId, profileFollowId, numberOfFollowers)
  hr.user-page
  div.userPosts
    div.user-page-content
      div.fixed-position
        img.user-profile-pic(src=`${meme.User.profilePicture}`)
        div.user-page-details
          div.profile-name-bar
            p.user-profile-name-bar= `${meme.User.username}'s Info`
            div.user-bio-description
              p= `${meme.User.biography}`
            div
              +followButton(meme.userId, currentUserId, isFollowing ? "Following" : "Follow", profileFollowId, isFollowing ? "unfollow-button" : "follow-button", "side-button")
        div.user-followings-details
          p.user-followings-header= `${meme.User.firstName}  ${meme.User.lastName} Follows`
          .user-followings-container
            each following in followings.slice(0, 5)
              .following-block
                a(href=`/users/${following.id}`): img(src=`${following.profilePicture}`)
                a.followings-link(href=`/users/${following.id}`)= `@${following.username}`
            a.see-all(href=`/users/${meme.User.id}/following`) See all

    div.user-feed
      ul
        h1.user-page= `${meme.headline}`
        h2.user-page= `${meme.caption}`
        img.user-meme(src=`${meme.link}` alt='meme')
        +likesAndComments(meme)
        +commentsModal(meme, currentUserId)
        p.posted-on= `Posted on: ${dateFormat}`
        hr.bottom-meme-page
        if currentUserId === meme.userId
          div.edit-delete
            a(href=`/memes/${meme.id}/edit`) Edit Your Meme
            a(href=`/memes/${meme.id}/delete`) Delete Your Meme
        div.bottom-of-page
